from bs4 import BeautifulSoup

def getSpecificTag(text, sp):
	for info in sp:
		if info.contents[1].find(text) > 0:
			break
	return info

def getImports(sp):
	info=getSpecificTag("PE imports", sp)
	s=""
	for c in info.findAllNext(name='a'):
		s+=str(c.string)
	s=s.split("[+]")
	c=s[len(s)-1].split('dll')[0]
	c+="dll"
	s=s[1:(len(s)-1)]
	s.append(c)
	return s

def getOpenFiles(sp):
	print(sp)

def getFilenames(sp):
	info=getSpecificTag("VirusTotal metadata", sp)
	s=""
	for c in info.findAllNext('td')[1]:
		s+=str(c).strip() 	
	return s.split("<br/>")[:-1]

def getDetailed(res):
	soup = BeautifulSoup(res, "lxml")
	base = soup.find_all('h5')

	imports=getImports(base)
	filenames=getFilenames(base)

	return imports+filenames

def getDetailedURL(res):
	return 0

def main():
	filename='infected.file'

if __name__ == "__main__":
	main()