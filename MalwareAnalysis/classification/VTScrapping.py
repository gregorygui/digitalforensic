from bs4 import BeautifulSoup

def getSpecificTag(text, sp):
	for info in sp:
		if info.contents[1].find(text) > 0:
			break
	return info

def getImports(sp):
	info=getSpecificTag("PE imports", sp)
	l=[]
	for c in info.findAllNext(name='a',attrs={'class':'expand-data'}):
		s=str(c.string)
		l.append(s[4:])
	return l

def getHash(sp):
	info=getSpecificTag("File identification", sp)
	l=[]
	for c in info.findAllNext(name='span', attrs={'class':'field-key'}):
		t=str(c.next_element.next_element)
		l.append(t[1:-2])
	return l[:3]

def getFilenames(sp):
	info=getSpecificTag("VirusTotal metadata", sp)
	l=[]
	c=info.findNext(name='td', attrs={'class':'field-value'})
	c=str(c.text)
	l=c[:-1].split("\n        \n        ")
	
	return l[1:]

def getDetailed(res):
	soup = BeautifulSoup(res, "lxml")
	base = soup.find_all('h5')

	result={'imports':getImports(base), 'filenames':getFilenames(base), 'hash':getHash(base)}

	return result

def getDetailedURL(res):
	return 0

def main():
	filename='tmp.txt'
	print(getDetailed(open('tmp.txt','rb').read()))

if __name__ == "__main__":
	main()