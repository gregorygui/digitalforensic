from datetime import datetime
import re

from VirusTotalAPI import getScore

# score / 10
# coef / 100

sectionsDefault=['.text', '.data', '.rdata', '.idata', '.edata', '.pdata', '.rsrc', '.reloc']

def detectIP(stringsList):
	regIP='^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])'
	score=0
	
	for s in stringsList:
		if re.match(regIP, s):
			score=7
			break

	return score

# def detectHostname(stringsList):
# 	regHostname='^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])'
# 	score=0

# 	for s in stringsList:
# 		if re.match(regHostname, s):
# 			score=7
# 			break

# 	return score

def inconsistentSections(sectionsList):
	score=0

	for s in sectionsList:
		if s not in sectionsDefault:
			score=5
			break

	return score

def inconsistentCompileDate(cdate):
	now = datetime.now()
	score=0

	if cdate > now:
		score=8
	
	return score

def VTScore(h):
	return getScore(h)*10

def main():
	print(VTScore("3145c517faf07480ca1f08ec44301503"))

if __name__ == '__main__':
	main()